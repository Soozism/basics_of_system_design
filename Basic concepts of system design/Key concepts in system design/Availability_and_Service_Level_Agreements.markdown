# دسترسی‌پذیری و توافق‌نامه‌های سطح خدمات (SLA)

این سند به بررسی مفاهیم دسترسی‌پذیری (Availability) و توافق‌نامه‌های سطح خدمات (Service Level Agreements یا SLA) در طراحی سیستم می‌پردازد. هدف این است که با ارائه تعریف، روش‌های اندازه‌گیری، استراتژی‌ها، مثال‌های واقعی، ابزارها، دیاگرام‌ها و منابع پیشنهادی، یک راهنمای جامع و آموزشی برای یادگیری عمیق فراهم شود. این محتوا به زبان فارسی و با فرمت مارک‌داون ارائه شده است تا برای مستندسازی آموزشی و یادگیری اصول طراحی سیستم مناسب باشد.

---

## مقدمه: دسترسی‌پذیری در طراحی سیستم چیست؟

**دسترسی‌پذیری** (Availability) به توانایی یک سیستم برای ارائه خدمات مورد انتظار به کاربران در زمان مورد نیاز اشاره دارد. در طراحی سیستم، دسترسی‌پذیری نشان‌دهنده میزان زمانی است که سیستم به‌صورت عملیاتی و قابل استفاده است. این معیار برای سیستم‌های مدرن، مانند پلتفرم‌های تجارت الکترونیک، سرویس‌های ابری یا اپلیکیشن‌های بلادرنگ، حیاتی است، زیرا قطعی حتی برای چند دقیقه می‌تواند منجر به از دست دادن درآمد یا اعتماد کاربران شود.

دسترسی‌پذیری معمولاً به‌صورت درصد زمان عملیاتی (Uptime) بیان می‌شود (مانند 99.9% یا "سه نُه") و یکی از مؤلفه‌های کلیدی در توافق‌نامه‌های سطح خدمات (SLA) است.

**اهمیت دسترسی‌پذیری:**
- **تجربه کاربری:** سیستم‌های با دسترسی‌پذیری بالا تجربه‌ای روان و بدون وقفه برای کاربران فراهم می‌کنند.
- **اعتماد تجاری:** قطعی‌های مکرر می‌تواند شهرت یک شرکت را خدشه‌دار کند.
- **الزامات قانونی و تجاری:** در برخی صنایع (مانند بانکداری یا مراقبت‌های بهداشتی)، دسترسی‌پذیری بالا الزامی است.

---

## نحوه اندازه‌گیری دسترسی‌پذیری

دسترسی‌پذیری به‌صورت درصد زمان عملیاتی (Uptime) محاسبه می‌شود، که نشان‌دهنده نسبت زمانی است که سیستم در دسترس است به کل زمان ممکن. فرمول آن به شرح زیر است:

\[
دسترسی‌پذیری = \frac{\text{زمان عملیاتی (Uptime)}}{\text{کل زمان (Total Time)}} \times 100
\]

**درصدهای رایج دسترسی‌پذیری:**
- **99% (دو نُه):** 3.65 روز قطعی در سال (مناسب برای سیستم‌های غیرحیاتی).
- **99.9% (سه نُه):** 8.76 ساعت قطعی در سال (مناسب برای وب‌سایت‌های تجاری).
- **99.99% (چهار نُه):** 52.56 دقیقه قطعی در سال (مناسب برای سیستم‌های حساس مانند بانکداری).
- **99.999% (پنج نُه):** 5.26 دقیقه قطعی در سال (برای سیستم‌های بسیار حیاتی مانند زیرساخت‌های مخابراتی).

**مثال:** اگر سیستمی در طول یک سال 8 ساعت قطعی داشته باشد، دسترسی‌پذیری آن به‌صورت زیر محاسبه می‌شود:
\[
دسترسی‌پذیری = \frac{365 \times 24 - 8}{365 \times 24} \times 100 \approx 99.91\%
\]

---

## توافق‌نامه سطح خدمات (SLA) چیست؟

### تعریف و هدف
**توافق‌نامه سطح خدمات (SLA)** یک قرارداد رسمی بین ارائه‌دهنده خدمات (مانند یک شرکت ابری) و مشتری است که سطح عملکرد و کیفیت خدمات را مشخص می‌کند. SLA شامل معیارهای قابل اندازه‌گیری است که تضمین می‌کنند خدمات با استانداردهای خاصی ارائه می‌شوند.

**هدف SLA:**
- تعیین انتظارات برای عملکرد سیستم (مانند دسترسی‌پذیری یا زمان پاسخ).
- ارائه معیاری برای ارزیابی عملکرد ارائه‌دهنده خدمات.
- مشخص کردن جبران خسارت (مانند اعتبار مالی) در صورت عدم رعایت معیارها.

### معیارهای رایج SLA
1. **دسترسی‌پذیری (Availability):** درصد زمان عملیاتی سیستم (مانند 99.9%).
2. **زمان پاسخ (Response Time):** حداکثر زمان لازم برای پاسخ به درخواست‌ها.
3. **زمان رفع اشکال (Resolution Time):** مدت زمانی که برای رفع مشکلات صرف می‌شود.
4. **پنجره‌های پشتیبانی:** ساعات و روش‌های دسترسی به پشتیبانی فنی.
5. **عملکرد (Performance):** مانند توان عملیاتی (Throughput) یا تأخیر (Latency).

**مثال:** SLA یک سرویس ابری ممکن است تضمین کند که دسترسی‌پذیری حداقل 99.9% باشد و مشکلات بحرانی در کمتر از 4 ساعت رفع شوند.

---

## تفاوت بین دسترسی‌پذیری و قابلیت اطمینان

| **معیار**               | **دسترسی‌پذیری (Availability)**                                      | **قابلیت اطمینان (Reliability)**                                   |
|-------------------------|---------------------------------------------------------------------|-------------------------------------------------------------------|
| **تعریف**              | درصد زمانی که سیستم عملیاتی و قابل استفاده است.                    | توانایی سیستم برای ارائه خدمات بدون خطا در شرایط عادی.          |
| **تمرکز**              | بر زمان عملیاتی بودن سیستم تمرکز دارد.                           | بر ارائه خدمات صحیح و بدون خطا تمرکز دارد.                       |
| **مثال**               | وب‌سایتی که 99.9% از زمان در دسترس است.                          | سیستمی که داده‌های صحیح را بدون خطا به کاربران ارائه می‌دهد.     |
| **ارتباط با خرابی**    | با تحمل خطا مرتبط است (سیستم در صورت خرابی همچنان کار می‌کند).   | با پیشگیری از خطاها مرتبط است (خطاها نباید رخ دهند).            |
| **معیار اندازه‌گیری**   | درصد زمان عملیاتی (مانند 99.99%).                                 | نرخ خطا یا میانگین زمان بین خرابی‌ها (MTBF).                    |

**مثال ترکیبی:** یک سیستم ممکن است دسترسی‌پذیری بالایی داشته باشد (با استفاده از افزونگی)، اما قابلیت اطمینان پایینی داشته باشد اگر داده‌های نادرست ارائه دهد.

---

## نحوه طراحی سیستم‌های با دسترسی‌پذیری بالا

برای دستیابی به دسترسی‌پذیری بالا، استراتژی‌های زیر استفاده می‌شوند:

### ۱. تعادل بار (Load Balancing)
- **توضیح:** توزیع درخواست‌های کاربران بین چندین سرور برای جلوگیری از بارگذاری بیش‌ازحد یک سرور.
- **ابزارها:** AWS Elastic Load Balancer (ELB)، NGINX، HAProxy.
- **مثال:** در یک وب‌سایت تجارت الکترونیک، تعادل‌کننده بار درخواست‌ها را بین سرورهای وب توزیع می‌کند.

### ۲. افزونگی (Redundancy)
- **توضیح:** ایجاد نسخه‌های اضافی از اجزای سیستم (مانند سرورها یا پایگاه‌های داده) برای جلوگیری از تک‌نقطه خرابی.
- **پیاده‌سازی:** استفاده از سرورهای پشتیبان یا تکرار داده‌ها در چندین مرکز داده.
- **مثال:** ذخیره‌سازی داده‌ها در چندین منطقه AWS برای اطمینان از دسترسی‌پذیری.

### ۳. مکانیزم‌های Failover و بازیابی فاجعه (Disaster Recovery)
- **Failover:** انتقال خودکار بار کاری به سرورهای پشتیبان در صورت خرابی.
- **بازیابی فاجعه:** برنامه‌ریزی برای بازیابی سیستم پس از خرابی‌های بزرگ (مانند قطعی یک مرکز داده).
- **ابزارها:** AWS Route 53 برای Failover DNS، یا ابزارهای مانند Zookeeper برای هماهنگی.
- **مثال:** نتفلیکس از Failover بین مناطق AWS برای ادامه خدمات در صورت خرابی یک منطقه استفاده می‌کند.

### ۴. مانیتورینگ و بررسی‌های سلامت (Health Checks)
- **توضیح:** بررسی مداوم وضعیت اجزای سیستم برای شناسایی مشکلات قبل از تأثیرگذاری بر کاربران.
- **ابزارها:** Prometheus، AWS CloudWatch، یا Datadog.
- **مثال:** تنظیم Health Checks در تعادل‌کننده بار برای حذف سرورهای معیوب از چرخه.

---

## مثال‌های واقعی از SLA

1. **Amazon Web Services (AWS):**
   - **SLA:** AWS برای سرویس EC2 دسترسی‌پذیری 99.99% را تضمین می‌کند.
   - **جبران خسارت:** اگر دسترسی‌پذیری به زیر 99.9% برسد، مشتریان اعتبار مالی دریافت می‌کنند.
   - **استراتژی‌ها:** افزونگی در مناطق مختلف، Auto Scaling، و مانیتورینگ با CloudWatch.

2. **Microsoft Azure:**
   - **SLA:** Azure برای ماشین‌های مجازی (VM) دسترسی‌پذیری 99.95% را تضمین می‌کند.
   - **جبران خسارت:** اعتبار مالی برای قطعی‌های بیش از حد مجاز.
   - **استراتژی‌ها:** استفاده از Azure Load Balancer و تکرار داده‌ها در پایگاه‌های داده Cosmos DB.

3. **Google Cloud Platform (GCP):**
   - **SLA:** GCP برای Compute Engine دسترسی‌پذیری 99.99% را ارائه می‌دهد.
   - **جبران خسارت:** اعتبار مالی برای عدم رعایت SLA.
   - **استراتژی‌ها:** استفاده از Spanner برای تکرار داده‌ها و Google Cloud Load Balancer.

---

## ابزارها و روش‌های نظارت و اجرای دسترسی‌پذیری و SLA

1. **ابزارهای مانیتورینگ:**
   - **Prometheus:** برای جمع‌آوری و تحلیل معیارهای سیستم (مانند زمان پاسخ و نرخ خطا).
   - **AWS CloudWatch:** برای نظارت بر معیارهای دسترسی‌پذیری و هشدار در مورد مشکلات.
   - **Datadog:** برای مانیتورینگ جامع سیستم‌های توزیع‌شده.

2. **بررسی‌های سلامت (Health Checks):**
   - تنظیم بررسی‌های سلامت در تعادل‌کننده‌های بار برای شناسایی سرورهای معیوب.
   - **مثال:** AWS ELB به‌طور خودکار سرورهایی که Health Check را پاس نمی‌کنند، از چرخه حذف می‌کند.

3. **مهندسی آشوب (Chaos Engineering):**
   - استفاده از ابزارهایی مانند **Chaos Monkey** (نتفلیکس) برای تست تاب‌آوری سیستم با شبیه‌سازی خرابی‌ها.
   - **مثال:** خاموش کردن تصادفی سرورها برای اطمینان از عملکرد Failover.

4. **اتوماسیون:**
   - استفاده از ابزارهایی مانند Terraform یا AWS Auto Scaling برای مدیریت خودکار زیرساخت‌ها.
   - **مثال:** افزودن خودکار سرورهای جدید در زمان اوج ترافیک.

---

## دیاگرام‌ها

### دیاگرام سیستم با دسترسی‌پذیری بالا

```
[کاربر] --> [تعادل‌کننده بار (ELB/NGINX)]
                     |
                     v
        +----------------------------+
        |                            |
        v                            v
 [سرور اصلی (منطقه ۱)]      [سرور پشتیبان (منطقه ۲)]
        |                            |
        v                            v
 [پایگاه داده اصلی]         [پایگاه داده تکراری]
        |                            |
        v                            v
 [مانیتورینگ (CloudWatch)]   [Failover (Route 53)]
```

**توضیح:**
- تعادل‌کننده بار درخواست‌ها را بین سرورهای اصلی و پشتیبان توزیع می‌کند.
- در صورت خرابی سرور اصلی، Failover به سرور پشتیبان انجام می‌شود.
- مانیتورینگ مداوم با CloudWatch مشکلات را شناسایی می‌کند.

---

## خلاصه و بهترین روش‌ها

- **دسترسی‌پذیری** معیاری برای زمان عملیاتی سیستم است و با درصدهایی مانند 99.9% یا 99.99% اندازه‌گیری می‌شود.
- **SLA** قراردادهایی هستند که سطح خدمات را تضمین کرده و معیارهایی مانند دسترسی‌پذیری و زمان پاسخ را مشخص می‌کنند.
- **بهترین روش‌ها:**
  - استفاده از افزونگی برای حذف تک‌نقطه خرابی.
  - پیاده‌سازی تعادل بار برای توزیع یکنواخت درخواست‌ها.
  - تنظیم مکانیزم‌های Failover و برنامه‌ریزی برای بازیابی فاجعه.
  - مانیتورینگ فعال با ابزارهایی مانند Prometheus یا CloudWatch.
  - تست تاب‌آوری با مهندسی آشوب برای شناسایی نقاط ضعف.
- **درس کلیدی:** دستیابی به دسترسی‌پذیری بالا نیازمند طراحی هوشمندانه، ابزارهای مناسب و پذیرش هزینه‌های اضافی است، اما برای سیستم‌های مقیاس بزرگ و حیاتی ضروری است.

---

## منابع پیشنهادی برای مطالعه بیشتر

1. *Designing Data-Intensive Applications* نوشته مارتین کلپمن: کتابی جامع برای یادگیری دسترسی‌پذیری و تحمل خطا.
2. *The System Design Primer* (منبع متن‌باز در GitHub): راهنمایی برای طراحی سیستم‌های با دسترسی‌پذیری بالا.
3. وبلاگ‌های مهندسی:
   - *AWS Architecture Blog*: مقالات در مورد SLA و دسترسی‌پذیری در AWS.
   - *Netflix Tech Blog*: توضیحات در مورد Chaos Engineering و تاب‌آوری.
   - *Google Cloud Blog*: مقالات در مورد Spanner و Load Balancing.
4. دوره‌های آنلاین:
   - *Grokking the System Design Interview* در DesignGuru.io
   - *System Design Course* در Educative.io
5. مستندات رسمی:
   - [AWS SLA](https://aws.amazon.com/legal/service-level-agreements/)
   - [Azure SLA](https://azure.microsoft.com/en-us/support/legal/sla/)
   - [Google Cloud SLA](https://cloud.google.com/terms/sla)

---

این سند مفهوم دسترسی‌پذیری و توافق‌نامه‌های سطح خدمات را به‌صورت جامع توضیح می‌دهد و برای مستندسازی آموزشی و یادگیری طراحی سیستم مناسب است. در صورت نیاز به توضیحات عمیق‌تر یا مثال‌های بیشتر، لطفاً اطلاع دهید!