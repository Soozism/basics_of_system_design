<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>الگوریتم‌های متعادل‌سازی بار: Round Robin و Least Connections</title>
    <link rel="stylesheet" href="../../css/style.css">
    <meta name="description" content="الگوریتم‌های متعادل‌سازی بار: Round Robin و Least Connections">
    <meta name="keywords" content="طراحی سیستم, مهندسی نرم‌افزار, معماری سیستم">
</head>
<body>
    <header>
        <div class="header-content">
            <a href="../../index.html" class="logo">طراحی سیستم</a>
            <nav>
                <ul class="nav-menu">
                    <li><a href="../../index.html">خانه</a></li>
                    <li><a href="../../index.html#basic-concepts">مفاهیم پایه</a></li>
                    <li><a href="../../index.html#main-components">اجزای اصلی</a></li>
                    <li><a href="../../index.html#scalable-systems">سیستم‌های مقیاس‌پذیر</a></li>
                    <li><a href="../../index.html#advanced-topics">موضوعات پیشرفته</a></li>
                    <li><a href="../../index.html#interviews">مصاحبه</a></li>
                </ul>
            </nav>
            <button class="mobile-menu-toggle">☰</button>
        </div>
    </header>

    <div class="container">
        <main class="main-content">
            <aside class="sidebar">
                
    <h3>الگوریتم‌های متعادل‌سازی بار: Round Robin و Least Connections</h3>
    <ul>
        <li><a href="../../../index.html">بازگشت به خانه</a></li>
        <li><a href="../../../index.html#basic-concepts">مفاهیم پایه</a></li>
        <li><a href="../../../index.html#main-components">اجزای اصلی</a></li>
        <li><a href="../../../index.html#scalable-systems">سیستم‌های مقیاس‌پذیر</a></li>
        <li><a href="../../../index.html#advanced-topics">موضوعات پیشرفته</a></li>
        <li><a href="../../../index.html#interviews">آمادگی مصاحبه</a></li>
    </ul>
    
            </aside>

            <article class="content">
                <div class="breadcrumb">
                    <a href="index.html">خانه</a>
<span>/</span>
<span>Designing scalable and reliable systems</span>
<span>/</span>
<span>Load Balancing</span>
<span>/</span>
<span>Load_Balancing_Algorithms.html</span>
                </div>

                <h1>الگوریتم‌های متعادل‌سازی بار: Round Robin و Least Connections</h1>

<p>این سند به بررسی دو الگوریتم متداول متعادل‌سازی بار، یعنی <strong>Round Robin</strong> و <strong>Least Connections</strong>، و نقش آن‌ها در توزیع ترافیک در سیستم‌های مقیاس‌پذیر می‌پردازد. هدف این است که با ارائه تعاریف، نحوه عملکرد، مزایا و معایب، مقایسه، سایر الگوریتم‌ها، ملاحظات عملی و بهترین روش‌ها، یک راهنمای جامع و آموزشی برای یادگیری طراحی سیستم فراهم شود. این محتوا به زبان فارسی و با فرمت مارک‌داون ارائه شده است تا برای مستندسازی آموزشی مناسب باشد.</p>

<p>---</p>

<h2>مقدمه: الگوریتم‌های متعادل‌سازی بار و نقش آن‌ها در توزیع ترافیک</h2>

<strong>متعادل‌سازی بار (Load Balancing)</strong> فرآیند توزیع ترافیک یا بار کاری (مانند درخواست‌های کاربران) بین چندین سرور یا منبع محاسباتی است تا از اضافه‌بار یک سرور جلوگیری کرده و عملکرد، مقیاس‌پذیری و قابلیت اطمینان سیستم بهبود یابد. <strong>الگوریتم‌های متعادل‌سازی بار</strong> تعیین می‌کنند که چگونه درخواست‌ها بین سرورهای موجود توزیع شوند. انتخاب الگوریتم مناسب به عواملی مانند نوع بار کاری، ظرفیت سرورها و نیازهای سیستم بستگی دارد.

<strong>چرا الگوریتم‌های متعادل‌سازی مهم هستند؟</strong>
<ul><li><strong>توزیع بهینه:</strong> اطمینان از توزیع یکنواخت یا هوشمند ترافیک برای بهبود عملکرد.</li></ul>
<ul><li><strong>جلوگیری از گلوگاه‌ها:</strong> کاهش فشار روی سرورهای خاص و جلوگیری از خرابی.</li></ul>
<ul><li><strong>افزایش دسترس‌پذیری:</strong> هدایت درخواست‌ها به سرورهای سالم برای حفظ پایداری.</li></ul>
<ul><li><strong>انعطاف‌پذیری:</strong> سازگاری با بارهای متغیر و نیازهای برنامه‌های مختلف.</li></ul>

<p>این سند دو الگوریتم پرکاربرد، Round Robin و Least Connections، را بررسی کرده و راهنمایی برای انتخاب مناسب ارائه می‌دهد.</p>

<p>---</p>

<h2>الگوریتم Round Robin</h2>

<h3>نحوه عملکرد (گام‌به‌گام)</h3>
<strong>Round Robin</strong> یک الگوریتم ساده و چرخشی است که درخواست‌های ورودی را به‌صورت متوالی و یکنواخت بین سرورهای موجود توزیع می‌کند.

<ul><li><strong>لیست سرورها:</strong> متعادل‌ساز بار لیستی از سرورهای موجود (مانند سرورهای A، B، C) را نگهداری می‌کند.</li></ul>
<ul><li><strong>تخصیص چرخشی:</strong> هر درخواست جدید به سرور بعدی در لیست هدایت می‌شود.</li></ul>
<ul><li><strong>چرخه تکراری:</strong> پس از رسیدن به آخرین سرور، چرخه از ابتدا شروع می‌شود.</li></ul>
<ul><li><strong>بررسی سلامت (Health Check):</strong> اگر سروری در دسترس نباشد، از چرخه حذف شده و درخواست به سرور بعدی هدایت می‌شود.</li></ul>

<strong>مثال:</strong>
<ul><li>فرض کنید سه سرور (A، B، C) داریم.</li></ul>
<ul><li>درخواست‌ها به ترتیب به سرورها هدایت می‌شوند: درخواست ۱ به A، درخواست ۲ به B، درخواست ۳ به C، درخواست ۴ به A، و غیره.</li></ul>

<h3>مزایا و معایب</h3>
<ul><li><strong>مزایا:</strong></li></ul>
  - <strong>سادگی:</strong> پیاده‌سازی و درک آن آسان است.
  - <strong>عادلانه برای سرورهای یکسان:</strong> اگر سرورها ظرفیت مشابهی داشته باشند، ترافیک به‌طور یکنواخت توزیع می‌شود.
  - <strong>مناسب برای بارهای سبک:</strong> برای سیستم‌هایی با ترافیک نسبتاً ثابت و سرورهای همگن مناسب است.
<ul><li><strong>معایب:</strong></li></ul>
  - <strong>عدم توجه به بار سرور:</strong> سرورهای پربار ممکن است درخواست‌های بیشتری دریافت کنند، که باعث کندی یا خرابی می‌شود.
  - <strong>نامناسب برای سرورهای ناهمگن:</strong> اگر سرورها ظرفیت متفاوتی داشته باشند، توزیع یکنواخت کارآمد نیست.
  - <strong>عدم پشتیبانی از وظایف زمان‌بر:</strong> درخواست‌های سنگین ممکن است یک سرور را بیش از حد مشغول کنند.

<h3>بهترین زمان استفاده</h3>
<ul><li><strong>سیستم‌های با سرورهای یکسان:</strong> زمانی که تمام سرورها مشخصات و ظرفیت مشابهی دارند.</li></ul>
<ul><li><strong>ترافیک ثابت:</strong> برای برنامه‌هایی با بار کاری نسبتاً یکنواخت (مانند وب‌سایت‌های استاتیک).</li></ul>
<ul><li><strong>پیاده‌سازی ساده:</strong> زمانی که سادگی و سرعت پیاده‌سازی اولویت دارد.</li></ul>
<ul><li><strong>مثال:</strong> توزیع ترافیک بین سرورهای وب یک وب‌سایت خبری با استفاده از NGINX.</li></ul>

<p>---</p>

<h2>الگوریتم Least Connections</h2>

<h3>نحوه عملکرد (گام‌به‌گام)</h3>
<strong>Least Connections</strong> درخواست‌ها را به سروری هدایت می‌کند که کمترین تعداد اتصال فعال (یا بار کاری) را دارد. این الگوریتم بار سرورها را در نظر می‌گیرد تا از اضافه‌بار جلوگیری کند.

<ul><li><strong>مانیتورینگ اتصالات:</strong> متعادل‌ساز بار تعداد اتصال‌های فعال هر سرور را رصد می‌کند.</li></ul>
<ul><li><strong>انتخاب سرور:</strong> درخواست جدید به سروری با کمترین تعداد اتصال فعال هدایت می‌شود.</li></ul>
<ul><li><strong>به‌روزرسانی پویا:</strong> با تغییر تعداد اتصالات (مانند پایان یک درخواست)، سرور با کمترین اتصال برای درخواست بعدی انتخاب می‌شود.</li></ul>
<ul><li><strong>بررسی سلامت:</strong> سرورهای معیوب از چرخه توزیع حذف می‌شوند.</li></ul>

<strong>مثال:</strong>
<ul><li>فرض کنید سه سرور (A، B، C) داریم با تعداد اتصال‌های فعال به ترتیب ۵، ۲، و ۸.</li></ul>
<ul><li>درخواست جدید به سرور B (با ۲ اتصال) هدایت می‌شود، زیرا کمترین بار را دارد.</li></ul>

<h3>مزایا و معایب</h3>
<ul><li><strong>مزایا:</strong></li></ul>
  - <strong>توزیع هوشمند:</strong> بار کاری را بر اساس وضعیت فعلی سرورها توزیع می‌کند.
  - <strong>مناسب برای بارهای متغیر:</strong> برای سیستم‌هایی با درخواست‌های زمان‌بر یا متغیر (مانند پردازش پرداخت) مناسب است.
  - <strong>بهینه برای سرورهای ناهمگن:</strong> حتی اگر سرورها ظرفیت متفاوتی داشته باشند، کارآمد عمل می‌کند.
<ul><li><strong>معایب:</strong></li></ul>
  - <strong>پیچیدگی بیشتر:</strong> نیاز به مانیتورینگ مداوم تعداد اتصالات.
  - <strong>سربار محاسباتی:</strong> محاسبه سرور با کمترین اتصال می‌تواند تأخیر جزئی ایجاد کند.
  - <strong>وابستگی به مانیتورینگ:</strong> اگر بررسی سلامت دقیق نباشد، ممکن است به سرورهای کند هدایت شود.

<h3>بهترین زمان استفاده</h3>
<ul><li><strong>سیستم‌های با بار متغیر:</strong> زمانی که درخواست‌ها زمان پردازش متفاوتی دارند (مانند پردازش تصاویر).</li></ul>
<ul><li><strong>سرورهای ناهمگن:</strong> زمانی که سرورها ظرفیت یا مشخصات متفاوتی دارند.</li></ul>
<ul><li><strong>برنامه‌های پویا:</strong> مانند اپلیکیشن‌های تجارت الکترونیک با ترافیک نوسانی.</li></ul>
<ul><li><strong>مثال:</strong> توزیع ترافیک در یک پلتفرم پخش ویدئو (مانند نتفلیکس) با استفاده از HAProxy.</li></ul>

<p>---</p>

<h2>مقایسه بین Round Robin و Least Connections</h2>

<p><td> <strong>معیار</strong>                </td> <strong>Round Robin</strong>                            <td> <strong>Least Connections</strong>                      </td>
<td>--------------------------</td>--------------------------------------------<td>--------------------------------------------</td>
<td> <strong>نحوه توزیع</strong>          </td> چرخشی و یکنواخت                          <td> بر اساس کمترین تعداد اتصال فعال          </td>
<td> <strong>پیچیدگی</strong>             </td> ساده                                      <td> پیچیده‌تر، نیاز به مانیتورینگ            </td>
<td> <strong>مناسب برای</strong>          </td> سرورهای یکسان، بار ثابت                  <td> سرورهای ناهمگن، بار متغیر               </td>
<td> <strong>مزایا</strong>               </td> سادگی، توزیع عادلانه                     <td> توزیع هوشمند، مناسب برای بارهای پویا      </td>
<td> <strong>معایب</strong>               </td> عدم توجه به بار سرور                     <td> سربار محاسباتی، وابستگی به مانیتورینگ   </td>
<td> <strong>موارد استفاده</strong>       </td> وب‌سایت‌های استاتیک، برنامه‌های ساده      <td> اپلیکیشن‌های پویا، میکروسرویس‌ها         </td>
<td> <strong>مثال ابزار</strong>          </td> NGINX، AWS ELB                            <td> HAProxy، Envoy                            </td></p>

<p>---</p>

<h2>مروری بر سایر الگوریتم‌های متداول متعادل‌سازی بار</h2>

<ul><li><strong>IP Hash:</strong></li></ul>
   - درخواست‌ها بر اساس هش آدرس IP کلاینت به سرور خاصی هدایت می‌شوند.
   - <strong>کاربرد:</strong> حفظ جلسه (Session Persistence) در برنامه‌هایی مانند سیستم‌های بانکی.
<ul><li><strong>Weighted Round Robin:</strong></li></ul>
   - نسخه پیشرفته Round Robin که وزن‌های مختلفی به سرورها اختصاص می‌دهد (بر اساس ظرفیت).
   - <strong>کاربرد:</strong> سیستم‌هایی با سرورهای ناهمگن.
<ul><li><strong>Weighted Least Connections:</strong></li></ul>
   - مشابه Least Connections، اما با در نظر گرفتن وزن سرورها.
   - <strong>کاربرد:</strong> سرورهای با ظرفیت‌های متفاوت.
<ul><li><strong>Random:</strong></li></ul>
   - درخواست‌ها به‌صورت تصادفی به سرورها هدایت می‌شوند.
   - <strong>کاربرد:</strong> سیستم‌های ساده با بار یکنواخت.

<p>---</p>

<h2>ملاحظات عملی در انتخاب الگوریتم‌ها</h2>

<h3>عوامل تأثیرگذار</h3>
<ul><li><strong>نوع بار کاری:</strong></li></ul>
   - برای بارهای ثابت و سرورهای یکسان (مانند وب‌سایت‌های استاتیک)، Round Robin مناسب است.
   - برای بارهای متغیر یا درخواست‌های زمان‌بر (مانند پردازش ویدئو)، Least Connections بهتر است.
<ul><li><strong>مشخصات سرورها:</strong></li></ul>
   - اگر سرورها ظرفیت یکسانی دارند، Round Robin کافی است.
   - اگر سرورها ناهمگن هستند، از Least Connections یا Weighted Round Robin استفاده کنید.
<ul><li><strong>نیاز به حفظ جلسه:</strong></li></ul>
   - برای برنامه‌هایی که نیاز به حفظ جلسه دارند (مانند اپلیکیشن‌های بانکی)، از IP Hash استفاده کنید.
<ul><li><strong>پیچیدگی و منابع:</strong></li></ul>
   - Round Robin به دلیل سادگی برای سیستم‌های کوچک مناسب است.
   - Least Connections نیاز به مانیتورینگ پیشرفته و منابع محاسباتی بیشتری دارد.
<ul><li><strong>مقیاس سیستم:</strong></li></ul>
   - در سیستم‌های بزرگ با ترافیک بالا (مانند میکروسرویس‌ها)، Least Connections یا الگوریتم‌های وزن‌دار کارآمدتر هستند.

<h3>مثال‌های واقعی</h3>
<ul><li><strong>وب‌سایت خبری:</strong> از Round Robin برای توزیع ترافیک بین سرورهای وب یکسان استفاده می‌کند.</li></ul>
<ul><li><strong>پلتفرم تجارت الکترونیک:</strong> از Least Connections برای مدیریت ترافیک در زمان اوج خرید (مانند Black Friday) استفاده می‌کند.</li></ul>
<ul><li><strong>اپلیکیشن بانکی:</strong> از IP Hash برای حفظ جلسه کاربران در تراکنش‌های آنلاین استفاده می‌کند.</li></ul>

<p>---</p>

<h2>خلاصه و بهترین روش‌ها</h2>

<h3>خلاصه</h3>
<ul><li><strong>الگوریتم‌های متعادل‌سازی بار:</strong> روش‌هایی برای توزیع ترافیک بین سرورها برای بهبود عملکرد و مقیاس‌پذیری.</li></ul>
<ul><li><strong>Round Robin:</strong> ساده و عادلانه، مناسب برای سرورهای یکسان و بارهای ثابت.</li></ul>
<ul><li><strong>Least Connections:</strong> هوشمند و پویا، مناسب برای سرورهای ناهمگن و بارهای متغیر.</li></ul>
<ul><li><strong>مقایسه:</strong> Round Robin ساده‌تر است، اما Least Connections برای بارهای پویا کارآمدتر است.</li></ul>
<ul><li><strong>درس کلیدی:</strong> انتخاب الگوریتم به نوع بار کاری، مشخصات سرورها و نیازهای سیستم بستگی دارد.</li></ul>

<h3>بهترین روش‌ها</h3>
<ul><li><strong>ارزیابی بار کاری:</strong></li></ul>
   - نوع و الگوی ترافیک (ثابت یا متغیر) را تحلیل کنید تا الگوریتم مناسب را انتخاب کنید.
<ul><li><strong>مانیتورینگ سرورها:</strong></li></ul>
   - از بررسی‌های سلامت (Health Checks) برای حذف سرورهای معیوب از چرخه توزیع استفاده کنید.
   - در Least Connections، تعداد اتصالات را به‌صورت بلادرنگ رصد کنید.
<ul><li><strong>ترکیب الگوریتم‌ها:</strong></li></ul>
   - در سیستم‌های پیچیده، از ترکیب الگوریتم‌ها (مانند Weighted Round Robin و Least Connections) استفاده کنید.
<ul><li><strong>امنیت و بهینه‌سازی:</strong></li></ul>
   - از SSL/TLS برای رمزگذاری ترافیک استفاده کنید.
   - معیارهای کلیدی مانند تأخیر، نرخ خطا و تعداد اتصالات را با ابزارهایی مانند Prometheus رصد کنید.
<ul><li><strong>ادغام با ابزارها:</strong></li></ul>
   - از متعادل‌سازهایی مانند NGINX، HAProxy یا AWS ELB برای پیاده‌سازی الگوریتم‌ها استفاده کنید.
   - در محیط‌های ابری، از قابلیت‌های Auto Scaling برای تنظیم پویا منابع استفاده کنید.
<ul><li><strong>آزمایش و بهینه‌سازی:</strong></li></ul>
   - الگوریتم‌ها را در محیط‌های آزمایشی تست کنید تا بهترین گزینه را برای سیستم خود انتخاب کنید.
   - عملکرد را با ابزارهای مانیتورینگ مانند Grafana بهینه کنید.

<p>---</p>

<h2>منابع پیشنهادی برای مطالعه بیشتر</h2>
<ul><li><em>Designing Data-Intensive Applications</em> نوشته مارتین کلپمن: کتابی جامع برای یادگیری طراحی سیستم‌های مقیاس‌پذیر.</li></ul>
<ul><li><em>The System Design Primer</em> (منبع متن‌باز در GitHub): راهنمایی برای طراحی سیستم‌های مدرن.</li></ul>
<ul><li>وبلاگ‌های مهندسی:</li></ul>
   - <em>NGINX Blog</em>: راهنمایی برای تنظیم الگوریتم‌های متعادل‌سازی در NGINX.
   - <em>HAProxy Blog</em>: مقالات در مورد الگوریتم‌های متعادل‌سازی و بهینه‌سازی.
   - <em>AWS Blog</em>: توضیحات در مورد الگوریتم‌های AWS ELB.
<ul><li>مستندات رسمی:</li></ul>
   - <a href="https://nginx.org/en/docs/">NGINX Documentation</a>
   - <a href="https://www.haproxy.org/#docs">HAProxy Documentation</a>
   - <a href="https://docs.aws.amazon.com/elasticloadbalancing/">AWS ELB Documentation</a>
<ul><li>دوره‌های آنلاین:</li></ul>
   - <em>Grokking the System Design Interview</em> در DesignGuru.io
   - <em>System Design Course</em> در Educative.io

<p>---</p>

<p>این سند الگوریتم‌های متعادل‌سازی بار Round Robin و Least Connections را به‌صورت جامع توضیح داده و برای مهندسان علاقه‌مند به طراحی سیستم‌های مقیاس‌پذیر مناسب است. در صورت نیاز به جزئیات بیشتر یا مثال‌های دیگر، لطفاً اطلاع دهید!</p>

                <div class="alert alert-info" style="margin-top: 2rem;">
                    <strong>نکته:</strong> این مطلب بخشی از مجموعه آموزش طراحی سیستم است. برای مطالعه سایر مطالب، از منوی کناری استفاده کنید.
                </div>
            </article>
        </main>
    </div>

    <footer>
        <div class="footer-content">
            <p>&copy; 2024 آموزش طراحی سیستم - تمام حقوق محفوظ است</p>
            <p>آخرین به‌روزرسانی: 2025-07-12</p>
        </div>
    </footer>

    <script src="../../js/script.js"></script>
</body>
</html>