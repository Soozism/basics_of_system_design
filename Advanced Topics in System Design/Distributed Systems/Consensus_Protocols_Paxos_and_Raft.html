<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>پروتکل‌های اجماع Paxos و Raft در سیستم‌های توزیع‌شده</title>
    <link rel="stylesheet" href="../../css/style.css">
    <meta name="description" content="پروتکل‌های اجماع Paxos و Raft در سیستم‌های توزیع‌شده">
    <meta name="keywords" content="طراحی سیستم, مهندسی نرم‌افزار, معماری سیستم">
</head>
<body>
    <header>
        <div class="header-content">
            <a href="../../index.html" class="logo">طراحی سیستم</a>
            <nav>
                <ul class="nav-menu">
                    <li><a href="../../index.html">خانه</a></li>
                    <li><a href="../../index.html#basic-concepts">مفاهیم پایه</a></li>
                    <li><a href="../../index.html#main-components">اجزای اصلی</a></li>
                    <li><a href="../../index.html#scalable-systems">سیستم‌های مقیاس‌پذیر</a></li>
                    <li><a href="../../index.html#advanced-topics">موضوعات پیشرفته</a></li>
                    <li><a href="../../index.html#interviews">مصاحبه</a></li>
                </ul>
            </nav>
            <button class="mobile-menu-toggle">☰</button>
        </div>
    </header>

    <div class="container">
        <main class="main-content">
            <aside class="sidebar">
                
    <h3>پروتکل‌های اجماع Paxos و Raft در سیستم‌های توزیع‌شده</h3>
    <ul>
        <li><a href="../../../index.html">بازگشت به خانه</a></li>
        <li><a href="../../../index.html#basic-concepts">مفاهیم پایه</a></li>
        <li><a href="../../../index.html#main-components">اجزای اصلی</a></li>
        <li><a href="../../../index.html#scalable-systems">سیستم‌های مقیاس‌پذیر</a></li>
        <li><a href="../../../index.html#advanced-topics">موضوعات پیشرفته</a></li>
        <li><a href="../../../index.html#interviews">آمادگی مصاحبه</a></li>
    </ul>
    
            </aside>

            <article class="content">
                <div class="breadcrumb">
                    <a href="index.html">خانه</a>
<span>/</span>
<span>Advanced Topics in System Design</span>
<span>/</span>
<span>Distributed Systems</span>
<span>/</span>
<span>Consensus_Protocols_Paxos_and_Raft.html</span>
                </div>

                <h1>پروتکل‌های اجماع Paxos و Raft در سیستم‌های توزیع‌شده</h1>

<h2>مقدمه‌ای بر نیاز به اجماع در سیستم‌های توزیع‌شده</h2>

<strong>اجماع (Consensus)</strong> در سیستم‌های توزیع‌شده به معنای توافق تمام گره‌های سالم بر روی یک مقدار یا تصمیم مشترک است، حتی در حضور خرابی‌ها یا مشکلات شبکه. اجماع برای اطمینان از <strong>هماهنگی</strong> و <strong>سازگاری</strong> در سیستم‌های توزیع‌شده حیاتی است.

<h3>چرا اجماع مورد نیاز است؟</h3>
<ul><li><strong>هماهنگی</strong>: در سیستم‌های توزیع‌شده، گره‌ها باید بر روی وظایفی مانند انتخاب رهبر، تخصیص منابع یا ترتیب عملیات توافق کنند.</li></ul>
<ul><li><strong>سازگاری داده‌ها</strong>: برای حفظ سازگاری (Consistency) در پایگاه‌های داده توزیع‌شده، گره‌ها باید بر روی ترتیب و محتوای به‌روزرسانی‌ها توافق کنند.</li></ul>
<ul><li><strong>تحمل‌پذیری خطا</strong>: سیستم‌های توزیع‌شده باید در برابر خرابی‌های گره‌ها یا پارتیشن‌بندی شبکه (Network Partition) مقاوم باشند و اجماع این امکان را فراهم می‌کند.</li></ul>

<h3>چالش‌های دستیابی به اجماع</h3>
<ul><li><strong>شبکه غیرقابل اعتماد</strong>: پیام‌ها ممکن است گم شوند، تأخیر داشته باشند یا به ترتیب نادرست برسند.</li></ul>
<ul><li><strong>خرابی گره‌ها</strong>: گره‌ها ممکن است از کار بیفتند یا به‌طور موقت از دسترس خارج شوند.</li></ul>
<ul><li><strong>مشکلات همگام‌سازی</strong>: ساعت‌های غیرهمگام (Clock Skew) می‌توانند ترتیب‌بندی رویدادها را مختل کنند.</li></ul>
<ul><li><strong>مشکل Split-Brain</strong>: در صورت پارتیشن‌بندی شبکه، ممکن است گره‌ها به دو گروه جداگانه تقسیم شوند و تصمیمات متضادی بگیرند.</li></ul>

<p>پروتکل‌های اجماع مانند <strong>Paxos</strong> و <strong>Raft</strong> برای غلبه بر این چالش‌ها طراحی شده‌اند و امکان توافق قابل اعتماد را در محیط‌های غیرقابل پیش‌بینی فراهم می‌کنند.</p>

<p>---</p>

<h2>مروری بر پروتکل Paxos</h2>

<strong>Paxos</strong> یکی از اولین و شناخته‌شده‌ترین پروتکل‌های اجماع است که توسط لزلی لمپورت در سال 1989 معرفی شد. این پروتکل برای اطمینان از توافق بین گره‌ها در سیستم‌های توزیع‌شده استفاده می‌شود.

<h3>مفاهیم و مراحل اصلی Paxos</h3>
Paxos شامل سه نقش اصلی است: <strong>پیشنهاددهنده (Proposer)</strong>، <strong>پذیرنده (Acceptor)</strong> و <strong>یادگیرنده (Learner)</strong>. فرآیند اجماع در سه مرحله انجام می‌شود:
<ul><li><strong>مرحله آماده‌سازی (Prepare)</strong>:</li></ul>
   - پیشنهاددهنده یک شماره پیشنهاد (Proposal Number) را به پذیرنده‌ها ارسال می‌کند.
   - پذیرنده‌ها بررسی می‌کنند که آیا این شماره بزرگ‌تر از شماره‌های قبلی است. اگر بله، قول می‌دهند که پیشنهادهای قدیمی‌تر را نپذیرند.
<ul><li><strong>مرحله پذیرش (Accept)</strong>:</li></ul>
   - اگر اکثریت پذیرنده‌ها پیشنهاد را تأیید کنند، پیشنهاددهنده یک مقدار پیشنهادی (Value) را به پذیرنده‌ها ارسال می‌کند.
   - پذیرنده‌ها این مقدار را می‌پذیرند، مشروط بر اینکه قول‌های قبلی نقض نشود.
<ul><li><strong>مرحله تأیید (Commit)</strong>:</li></ul>
   - پس از پذیرش مقدار توسط اکثریت پذیرنده‌ها، یادگیرنده‌ها از مقدار توافق‌شده مطلع می‌شوند.

<h3>نقاط قوت و پیچیدگی Paxos</h3>
<ul><li><strong>نقاط قوت</strong>:</li></ul>
  - تحمل خرابی‌های متعدد (تا زمانی که اکثریت گره‌ها سالم باشند).
  - تضمین ایمنی (Safety): هیچ‌گاه دو مقدار متضاد تأیید نمی‌شوند.
  - مناسب برای سیستم‌های پیچیده با نیاز به سازگاری قوی.
<ul><li><strong>پیچیدگی</strong>:</li></ul>
  - درک و پیاده‌سازی Paxos دشوار است، زیرا شامل مراحل متعدد و مدیریت پیام‌های پیچیده است.
  - بهینه‌سازی عملکرد آن چالش‌برانگیز است، به‌ویژه در مقیاس‌های بزرگ.
  - مستعد بن‌بست (Deadlock) است اگر چندین پیشنهاددهنده به‌طور همزمان رقابت کنند.

<p>---</p>

<h2>مروری بر پروتکل Raft</h2>

<strong>Raft</strong> یک پروتکل اجماع است که در سال 2014 توسط دیگو اونگارو و جان اوسترهاوت معرفی شد. هدف Raft ساده‌سازی مفاهیم اجماع نسبت به Paxos و ارائه یک پروتکل قابل فهم‌تر بود.

<h3>اهداف طراحی Raft</h3>
<ul><li><strong>قابلیت درک</strong>: Raft به‌گونه‌ای طراحی شده که برای مهندسان و توسعه‌دهندگان قابل فهم باشد.</li></ul>
<ul><li><strong>ایمنی و تحمل‌پذیری خطا</strong>: مانند Paxos، Raft ایمنی را تضمین می‌کند و در برابر خرابی‌ها مقاوم است.</li></ul>
<ul><li><strong>عملکرد عملی</strong>: Raft برای استفاده در سیستم‌های واقعی بهینه شده است.</li></ul>

<h3>اجزای کلیدی Raft</h3>
<ul><li><strong>انتخاب رهبر (Leader Election)</strong>:</li></ul>
   - گره‌ها در یکی از سه حالت هستند: <strong>رهبر (Leader)</strong>، <strong>پیرو (Follower)</strong> یا <strong>کاندیدا (Candidate)</strong>.
   - اگر رهبر از دسترس خارج شود، گره‌ها با رأی‌گیری یک رهبر جدید انتخاب می‌کنند.
   - برای جلوگیری از Split-Brain، تنها گره‌ای که اکثریت آرا را کسب کند، رهبر می‌شود.
<ul><li><strong>تکثیر لاگ (Log Replication)</strong>:</li></ul>
   - رهبر تمام به‌روزرسانی‌ها را به‌صورت لاگ به پیروان ارسال می‌کند.
   - پیروان لاگ‌ها را کپی کرده و تأیید می‌کنند، که تضمین می‌کند داده‌ها در تمام گره‌ها سازگار هستند.
<ul><li><strong>ایمنی (Safety)</strong>:</li></ul>
   - Raft تضمین می‌کند که فقط یک رهبر در هر دوره (Term) وجود دارد.
   - قوانین سخت‌گیرانه‌ای برای اطمینان از سازگاری لاگ‌ها اعمال می‌شود.

<h3>نقاط قوت Raft</h3>
<ul><li>درک و پیاده‌سازی آسان‌تر نسبت به Paxos.</li></ul>
<ul><li>مدیریت واضح‌تر انتخاب رهبر و تکثیر لاگ.</li></ul>
<ul><li>بهینه برای سیستم‌های واقعی با نیاز به هماهنگی ساده.</li></ul>

<p>---</p>

<h2>مقایسه Paxos و Raft</h2>

<h3>تفاوت‌ها</h3>
<ul><li><strong>پیچیدگی و قابلیت درک</strong>:</li></ul>
   - <strong>Paxos</strong>: پیچیده و دشوار برای پیاده‌سازی. توضیح مراحل آن برای مهندسان جدید چالش‌برانگیز است.
   - <strong>Raft</strong>: طراحی شده تا قابل فهم باشد، با مراحل واضح و مستندات بهتر.
<ul><li><strong>مدیریت رهبر</strong>:</li></ul>
   - <strong>Paxos</strong>: از چندین پیشنهاددهنده پشتیبانی می‌کند، که می‌تواند به رقابت و بن‌بست منجر شود.
   - <strong>Raft</strong>: همیشه یک رهبر واحد در هر دوره دارد، که هماهنگی را ساده‌تر می‌کند.
<ul><li><strong>کارایی و بهینه‌سازی</strong>:</li></ul>
   - <strong>Paxos</strong>: برای سناریوهای پیچیده‌تر مناسب است، اما بهینه‌سازی آن دشوار است.
   - <strong>Raft</strong>: برای اکثر موارد عملی بهینه‌تر است و پیاده‌سازی‌های استاندارد آن (مانند etcd) عملکرد خوبی دارند.
<ul><li><strong>پذیرش در صنعت</strong>:</li></ul>
   - <strong>Paxos</strong>: در سیستم‌های قدیمی‌تر و پیچیده مانند Google Chubby استفاده شده است.
   - <strong>Raft</strong>: به دلیل سادگی، در ابزارهای مدرن مانند etcd و Consul محبوبیت بیشتری دارد.

<h3>موارد استفاده مناسب</h3>
<ul><li><strong>Paxos</strong>: مناسب برای سیستم‌هایی که نیاز به انعطاف‌پذیری بالا و تحمل سناریوهای پیچیده دارند (مانند Google Spanner یا Chubby).</li></ul>
<ul><li><strong>Raft</strong>: مناسب برای سیستم‌هایی که نیاز به پیاده‌سازی ساده و قابل فهم دارند (مانند etcd، Consul یا سیستم‌های مبتنی بر Kubernetes).</li></ul>

<p>---</p>

<h2>سیستم‌های واقعی استفاده‌کننده از Paxos یا Raft</h2>

<ul><li><strong>Google Chubby</strong>:</li></ul>
   - <strong>پروتکل</strong>: Paxos.
   - <strong>کاربرد</strong>: یک سرویس قفل توزیع‌شده که برای هماهنگی بین سرویس‌های گوگل (مانند GFS و Bigtable) استفاده می‌شود.
   - <strong>چرا Paxos؟</strong>: Chubby به سازگاری قوی و تحمل سناریوهای پیچیده نیاز دارد، که Paxos آن را فراهم می‌کند.

<ul><li><strong>etcd</strong>:</li></ul>
   - <strong>پروتکل</strong>: Raft.
   - <strong>کاربرد</strong>: ذخیره‌سازی کلید-مقدار توزیع‌شده که در Kubernetes برای مدیریت پیکربندی و هماهنگی استفاده می‌شود.
   - <strong>چرا Raft؟</strong>: سادگی پیاده‌سازی و قابلیت اطمینان بالا.

<ul><li><strong>Consul</strong>:</li></ul>
   - <strong>پروتکل</strong>: Raft.
   - <strong>کاربرد</strong>: ابزار کشف سرویس و مدیریت پیکربندی در سیستم‌های توزیع‌شده.
   - <strong>چرا Raft؟</strong>: Consul از Raft برای ارائه یک پروتکل اجماع قابل فهم و کارآمد استفاده می‌کند.

<p>---</p>

<h2>اهمیت پروتکل‌های اجماع در سیستم‌های توزیع‌شده</h2>

<p>پروتکل‌های اجماع مانند Paxos و Raft ستون فقرات سیستم‌های توزیع‌شده مقاوم در برابر خرابی و با دسترسی بالا هستند:
<ul><li><strong>تحمل‌پذیری خطا</strong>: این پروتکل‌ها تضمین می‌کنند که سیستم حتی در صورت خرابی گره‌ها یا پارتیشن‌بندی شبکه به کار خود ادامه دهد.</li></ul>
<ul><li><strong>سازگاری قوی</strong>: با استفاده از اجماع، سیستم‌ها می‌توانند داده‌های سازگار را در سراسر گره‌ها حفظ کنند.</li></ul>
<ul><li><strong>هماهنگی</strong>: پروتکل‌های اجماع امکان انتخاب رهبر، تخصیص منابع و ترتیب‌بندی عملیات را فراهم می‌کنند.</li></ul>
<ul><li><strong>مقیاس‌پذیری</strong>: با مدیریت هماهنگی بین گره‌ها، این پروتکل‌ها به سیستم‌ها اجازه می‌دهند تا در مقیاس‌های بزرگ عمل کنند.</li></ul></p>

<p>---</p>

<h2>نتیجه‌گیری</h2>

<p>پروتکل‌های اجماع Paxos و Raft ابزارهای کلیدی برای حل مشکلات هماهنگی و سازگاری در سیستم‌های توزیع‌شده هستند. <strong>Paxos</strong> با وجود پیچیدگی، برای سیستم‌های پیچیده با نیازهای خاص مناسب است و در محصولاتی مانند Google Chubby استفاده شده است. <strong>Raft</strong> با تمرکز بر سادگی و قابلیت درک، در ابزارهای مدرن مانند etcd و Consul محبوبیت یافته است. مهندسان نرم‌افزار باید با توجه به نیازهای سیستم (مانند پیچیدگی، مقیاس‌پذیری و سهولت پیاده‌سازی) پروتکل مناسب را انتخاب کنند. درک این پروتکل‌ها برای طراحی سیستم‌های توزیع‌شده مقاوم و کارآمد ضروری است.</p>

                <div class="alert alert-info" style="margin-top: 2rem;">
                    <strong>نکته:</strong> این مطلب بخشی از مجموعه آموزش طراحی سیستم است. برای مطالعه سایر مطالب، از منوی کناری استفاده کنید.
                </div>
            </article>
        </main>
    </div>

    <footer>
        <div class="footer-content">
            <p>&copy; 2024 آموزش طراحی سیستم - تمام حقوق محفوظ است</p>
            <p>آخرین به‌روزرسانی: 2025-07-12</p>
        </div>
    </footer>

    <script src="../../js/script.js"></script>
</body>
</html>